{% extends 'base.html' %}

{% block title %}Ask your question{% endblock %}

{% block bodyclasses %}question-form{% endblock %}

{% block content %}
<div class="header">
    <h1>Ask your question</h1>
</div>
<div class="question-form">
    <form method="post">
        {% csrf_token %}

        {% if form.non_field_errors %}
            <div class="island">
                {{ form.non_field_errors }}
            </div>
        {% endif %}

        {% for hidden in form.hidden_fields %}
            {{ hidden }}
        {% endfor %}

        <fieldset class="island">
            <ul class="gw">
                <li class="g  three-quarters  lap-one-half  palm-one-whole">
                    {{ form.description.errors }}
                    {{ form.description }}
                    <p class="info">Including as much information as possible to help us to help you.</p>
                </li>
                <li class="g  one-quarter  lap-one-half  palm-one-whole">
                    <label for="id_postcode">Post code</label>
                    {{ form.postcode.errors }}
                    {{ form.postcode }}
                </li>
            </ul>
        </fieldset>

        <fieldset class="island">
            <label for="id_category">Category</label>

            <p class="info">Please select the category that best describes your problem</p>

            {{ form.category.errors }}

            <ul class="radio-list">
                {% for radio in form.category %}
                    <li>{{ radio }}</li>
                {% endfor %}
            </ul>
        </fieldset>

        <fieldset class="island">
            <ul class="gw">
                <li class="g  one-half  palm-one-whole">
                    <label for="id_reporter_name">Your Name <span class="info">(This is optional - you can ask questions anonymously)</span></label>
                    {{ form.reporter_name.errors }}
                    {{ form.reporter_name }}
                </li>
                <li class="g  one-half  palm-one-whole">
                    <label for="id_reporter_phone">Your Contact Number <span class="info">(You must enter a contact number OR email address)</span></label>
                    {{ form.reporter_phone.errors }}
                    {{ form.reporter_phone }}
                </li>
                <li class="g  one-half  palm-one-whole">
                    <label for="id_reporter_email">Your Email Address <span class="info">(You must enter a contact number OR email address)</span></label>
                    {{ form.reporter_email.errors }}
                    {{ form.reporter_email }}
                </li>
                <li class="g  one-whole">
                    <label for="id_preferred_contact_method_0">Preferred contact method</label>
                    {{ form.preferred_contact_method.errors }}
                    <ul class="radio-list">
                        {% for radio in form.preferred_contact_method %}
                            <li>{{ radio }}</li>
                        {% endfor %}
                    </ul>
                </li>
            </ul>
        </fieldset>

        <fieldset class="big-radio-group">
            <!-- <label for="id_privacy_0">Privacy</label> -->
            {{ form.privacy.errors }}
            <ul>
                <li class="big-radio-group__first  big-radio-group--green">
                    <div class="big-radio-group__table">
                        <label for="id_privacy_0" class="big-radio-group__row">
                            <input checked="checked" type="radio" id="id_privacy_0" value="0" name="privacy" />
                            <span class="big-radio-group__cell">Keep all details private</span>
                        </label>
                    </div>
                </li>
                <li>
                    <div class="big-radio-group__table">
                        <label for="id_privacy_1" class="big-radio-group__row">
                            <input type="radio" id="id_privacy_1" value="1" name="privacy" />
                            <span class="big-radio-group__cell">Publish question and response but not my name</span>
                        </label>
                    </div>
                </li>
                <li class="big-radio-group__last">
                    <div class="big-radio-group__table">
                        <label for="id_privacy_2" class="big-radio-group__row">
                            <input type="radio" id="id_privacy_2" value="2" name="privacy" />
                            <span class="big-radio-group__cell">Publish question and response with my name</span>
                        </label>
                    </div>
                </li>
            </ul>
        </fieldset>

        <fieldset>
            <button class="btn  fr" type="submit">Submit</button>
        </fieldset>
    </form>
    {% endblock content %}

    {% block extra_js %}
        <script type="text/javascript">
          $(function(){
            $('.big-radio-group').each(function(){
              var $t = $(this);

              // add dummy radio element
              $('input[type=radio]', $t).each(function(){
                $(this).hide().after('<div class="big-radio-group__cell"><div class="big-radio-group__radio"></div></div>');
              });

              // bind the click event so we can update the actual inputs
              $('li', $t).on('click', function(){
                $('li', $t).removeClass('big-radio-group--active');
                $('input[type=radio]', $(this)).prop("checked", true);
                $(this).addClass('big-radio-group--active');
              });
            });


          });

          // bind the onload event so we can trigger the click on
          // whichever one is already selected
          $(window).load(function(){
            $('.big-radio-group input[type=radio]').each(function(){
              if($(this).is(':checked')){
                console.log('checked!!');
                $(this).parents('li').click();
              }
            });
          });
        </script>
    {% endblock extra_js %}