{% extends 'organisations/includes/table.html' %}
{% spaceless %}
{% load django_tables2 %}
{% load i18n %}
{% load organisation_extras %}

{% block table %}
<div class="table-wrapper">
    <table class="dashboard-table dashboard-table--expanded">
        {% nospaceless %}
        {% block table.thead %}
        <thead>
            <tr class="dashboard-table__head dashboard-table__head--bordered">
            {% for column in table.columns %}
                {% if column.orderable %}
                <th {{ column.attrs.th.as_html }}><a href="{% querystring table.prefixed_order_by_field=column.order_by_alias.next %}">{{ column.header }}</a></th>
                {% else %}
                <th {{ column.attrs.th.as_html }}>{{ column.header }}</th>
                {% endif %}
            {% endfor %}
            {# An extra header for the breach/escalation flags #}
            <th></th>
            </tr>
        </thead>
        {% endblock table.thead %}
        {% block table.tbody %}
            {% for row in table.page.object_list|default:table.rows %} {# support pagination #}
            {% block table.tbody.row %}
            <tr class="{{ table|row_classes:row.record }}">
                <td class="dashboard-table__heavy-text {% if row.record.priority %}dashboard-table__hightlight{% endif %}">{{ row.reference_number }}</td>
                <td class="dashboard-table__light-text"><em>{{ row.created }}</em></td>
                <td>{{ row.category }}</td>
                <td>{{ row.service }}</td>
                <td width="250px" class="dashboard-table__light-text">{{ row.summary }}</td>
                <td class="dashboard-table__flag">
                    <div class="dashboard-table__flag__breach">b</div>
                    <div class="dashboard-table__flag__escalate">e</div>
                </td>
            </tr>
            {% endblock table.tbody.row %}
            {% empty %}
            {% if table.empty_text %}
            {% block table.tbody.empty_text %}
            <tr><td colspan="{{ table.columns|length }}">{{ table.empty_text }}</td></tr>
            {% endblock table.tbody.empty_text %}
            {% endif %}
            {% endfor %}
        {% endblock table.tbody %}
        {% block table.tfoot %}
            {{ block.super }}
        {% endblock table.tfoot %}
        {% endnospaceless %}
    </table>
</div>
{% table_paginator %}

{% endblock table %}

{% endspaceless %}
